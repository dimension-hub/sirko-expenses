<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <title>–í–∏—Ç—Ä–∞—Ç–∏ –∫–ª—É–±—É ¬´–°—ñ—Ä–∫–æ¬ª</title>
  <link rel="manifest" href="manifest.json" />
  <meta name="theme-color" content="#43766c" />
  <link rel="icon" href="logo.png" />
  <link rel="apple-touch-icon" href="logo.png" />
  <script src="https://accounts.google.com/gsi/client" async defer></script>
  <style>
    :root {
      --primary: #43766c;
      --accent: #ffb84c;
      --bg: #fefbf6;
      --text: #222;
      --radius: 14px;
      --shadow: 0 6px 18px rgba(0, 0, 0, 0.08);
      --font: 'Inter', 'Segoe UI', system-ui, sans-serif;
    }
    body {
      font-family: var(--font);
      margin: 0;
      padding: 2rem;
      background: var(--bg);
      color: var(--text);
    }
    h2 {
      text-align: center;
      color: var(--primary);
    }
    form {
      display: none;
      max-width: 600px;
      margin: auto;
      background: white;
      padding: 2rem;
      border-radius: var(--radius);
      box-shadow: var(--shadow);
    }
    label {
      display: block;
      margin-top: 1rem;
    }
    input, select, textarea {
      width: 100%;
      padding: 0.8rem;
      margin-top: 0.3rem;
      border-radius: var(--radius);
      border: 1px solid #ccc;
      font-size: 1rem;
    }
    button {
      margin-top: 1.5rem;
      width: 100%;
      padding: 1rem;
      font-size: 1.1rem;
      background: linear-gradient(to right, var(--primary), var(--accent));
      color: white;
      border: none;
      border-radius: var(--radius);
      cursor: pointer;
    }
    #unauthorized {
      text-align: center;
      color: red;
      font-weight: bold;
      margin-top: 2rem;
    }
    .toast {
      position: fixed;
      bottom: 30px;
      left: 50%;
      transform: translateX(-50%);
      background: #222;
      color: #fff;
      padding: 1rem 1.5rem;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
      z-index: 9999;
      animation: fadeInOut 4s ease-in-out forwards;
    }
    @keyframes fadeInOut {
      0% { opacity: 0; transform: translateY(20px) translateX(-50%); }
      10% { opacity: 1; transform: translateY(0) translateX(-50%); }
      90% { opacity: 1; }
      100% { opacity: 0; transform: translateY(-20px) translateX(-50%); }
    }
  </style>
</head>
<body>
  <div style="text-align: center; margin-top: 1rem;">
    <img src="logo.png" alt="SIRKO" style="width: 96px; height: 96px; border-radius: 16px;">
  </div>
  <h2>–í–∏—Ç—Ä–∞—Ç–∏ –∫–ª—É–±—É ¬´–°—ñ—Ä–∫–æ¬ª</h2>

  <div id="g_id_onload"
    data-client_id="489497462381-t1ve6ae6jlmg9jm83lkguv5t0l962urc.apps.googleusercontent.com"
    data-callback="handleCredentialResponse"
    data-auto_prompt="false">
  </div>
  <div class="g_id_signin"
    data-type="standard"
    data-size="large"
    data-theme="outline"
    data-text="sign_in_with"
    data-shape="rectangular"
    data-logo_alignment="left">
  </div>

  <form id="expenseForm">
    <label for="info">üìÑ –©–æ –±—É–ª–æ –æ–ø–ª–∞—á–µ–Ω–æ?</label>
    <input type="text" name="info" id="info" required />
    <label for="category">üóÇ –ö–∞—Ç–µ–≥–æ—Ä—ñ—è</label>
    <select name="category" id="category" required>
      <option value="">–û–±–µ—Ä—ñ—Ç—å –∫–∞—Ç–µ–≥–æ—Ä—ñ—é</option>
      <option>üè† –û—Ä–µ–Ω–¥–∞ —Ç–∞ —ñ–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞</option>
      <option>üîß –¢—Ä–µ–Ω–µ—Ä–∏ —Ç–∞ –ø–µ—Ä—Å–æ–Ω–∞–ª</option>
      <option>ü¶¥ –•–∞—Ä—á—É–≤–∞–Ω–Ω—è, –ª–∞—Å–æ—â—ñ, –º–æ—Ç–∏–≤–∞—Ü—ñ—è</option>
      <option>üíº –ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ñ –≤–∏—Ç—Ä–∞—Ç–∏</option>
      <option>üì¢ –†–µ–∫–ª–∞–º–∞ —Ç–∞ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥</option>
      <option>üßπ –ß–∏—Å—Ç–æ—Ç–∞ —Ç–∞ –≥—ñ–≥—ñ—î–Ω–∞</option>
      <option>üöó –¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ñ –≤–∏—Ç—Ä–∞—Ç–∏</option>
      <option>üéì –û—Å–≤—ñ—Ç–∞ —ñ —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è</option>
      <option>üì¶ –û–±–ª–∞–¥–Ω–∞–Ω–Ω—è —Ç–∞ —Ä–µ–º–æ–Ω—Ç</option>
      <option>üê∂ –í–∏—Ç—Ä–∞—Ç–∏ –Ω–∞ —Å–æ–±–∞–∫ –∫–ª—É–±—É</option>
      <option>üì± –û–Ω–ª–∞–π–Ω –ø–æ–∫—É–ø–∫–∏ —ñ –ø—ñ–¥–ø–∏—Å–∫–∏</option>
      <option>üìä –ù–µ–ø–µ—Ä–µ–¥–±–∞—á—É–≤–∞–Ω—ñ –≤–∏—Ç—Ä–∞—Ç–∏</option>
    </select>
    <label for="payer">üë§ –ö–∏–º –æ–ø–ª–∞—á–µ–Ω–æ</label>
    <input type="email" name="payer" id="payer" placeholder="@sirko.club" required />
    <label for="amount">üí∞ –°—É–º–∞</label>
    <input type="number" name="amount" id="amount" step="0.01" min="0" required />
    <label for="date">üìÜ –î–∞—Ç–∞</label>
    <input type="date" name="date" id="date" required />
    <label for="notes">üìù –ö–æ–º–µ–Ω—Ç–∞—Ä</label>
    <textarea name="notes" id="notes"></textarea>
    <button type="submit">‚úÖ –ù–∞–¥—ñ—Å–ª–∞—Ç–∏ –≤–∏—Ç—Ä–∞—Ç—É</button>
  </form>

  <div id="unauthorized"></div>

  <script>
    function showToast(message) {
      const toast = document.createElement('div');
      toast.className = 'toast';
      toast.textContent = message;
      document.body.appendChild(toast);
      setTimeout(() => toast.remove(), 4000);
    }

    function handleCredentialResponse(response) {
      const idToken = response.credential;
      const payload = JSON.parse(atob(idToken.split('.')[1].replace(/-/g, '+').replace(/_/g, '/')));
      const email = payload.email;

      if (email.endsWith('@sirko.club')) {
        document.getElementById('expenseForm').style.display = 'block';
        document.querySelector('.g_id_signin').style.display = 'none';
        document.getElementById('unauthorized').style.display = 'none';
      } else {
        document.getElementById('expenseForm').style.display = 'none';
        document.querySelector('.g_id_signin').style.display = 'none';
        document.getElementById('unauthorized').textContent =
          '‚õî –î–æ—Å—Ç—É–ø –¥–æ–∑–≤–æ–ª–µ–Ω–æ –ª–∏—à–µ –¥–ª—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ @sirko.club';
        document.getElementById('unauthorized').style.display = 'block';
      }
    }

    document.addEventListener("DOMContentLoaded", () => {
      const form = document.getElementById('expenseForm');

      form.addEventListener('submit', function (e) {
        e.preventDefault();
        const data = {
          info: form.info.value,
          category: form.category.value,
          payer: form.payer.value,
          amount: form.amount.value,
          date: form.date.value,
          notes: form.notes.value
        };

        fetch('https://script.google.com/macros/s/AKfycbyXr__EZOUK3LGBlSjSSml5pHjsz5bChhiDmYOLhivCcdTSQIsounJgfIm6k6qUQw3k/exec', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(data),
        })
          .then(res => {
            if (!res.ok) throw new Error("Network error");
            showToast("‚úÖ –î–∞–Ω—ñ —É—Å–ø—ñ—à–Ω–æ –Ω–∞–¥—ñ—Å–ª–∞–Ω—ñ!");
            form.reset();
          })
          .catch(() => {
            showToast("‚ö†Ô∏è –ü–æ–º–∏–ª–∫–∞! –ê–ª–µ –º–æ–∂–ª–∏–≤–æ, –¥–∞–Ω—ñ –∑–±–µ—Ä–µ–∂–µ–Ω–æ.");
          });
      });
    });
  </script>
</body>
</html>
